import{_ as a,c as i,o as n,ag as l}from"./chunks/framework.CDhRSyRB.js";const p="/assets/ready.DbpZ8Ew3.png",e="/assets/ocr_result.Br6Bu7-8.png",t="/assets/map_result.D0k6VCXZ.png",h="/assets/preview.BrXecuFl.mp4",b=JSON.parse('{"title":"§10.2 运行仿真¶","description":"","frontmatter":{},"headers":[],"relativePath":"src/aircraft/ch10-simulation/s2.md","filePath":"src/aircraft/ch10-simulation/s2.md"}'),r={name:"src/aircraft/ch10-simulation/s2.md"};function k(d,s,o,c,F,g){return n(),i("div",null,s[0]||(s[0]=[l('<h1 id="§10-2-运行仿真¶" tabindex="-1">§10.2 运行仿真¶ <a class="header-anchor" href="#§10-2-运行仿真¶" aria-label="Permalink to &quot;§10.2 运行仿真¶&quot;">​</a></h1><p>在本节运行仿真然后查看结果: 基于视觉语言大模型(VLM)的无人机室内自主侦察仿真.实现无人机自主起飞, 避开障碍物以及穿过门洞进入第二个房间, 移动到字母<code>B</code>前面发射激光.</p><h2 id="获取仿真程序并打开" tabindex="-1">获取仿真程序并打开 <a class="header-anchor" href="#获取仿真程序并打开" aria-label="Permalink to &quot;获取仿真程序并打开&quot;">​</a></h2><p>下载[<a href="https://github.com/ByeIO/bye.orbslam3.rs/tree/dev1/crates/seekslam_webots" target="_blank" rel="noreferrer">https://github.com/ByeIO/bye.orbslam3.rs/tree/dev1/crates/seekslam_webots</a>]文件夹并打开<code>./worlds/mission6.wbt</code>文件, 如果顺利的话你将会看到如下画面:</p><table tabindex="0"><thead><tr><th>仿真画面</th></tr></thead><tbody><tr><td><img src="'+p+`" alt=""></td></tr></tbody></table><p>不过先不要着急运行, 先配置运行环境.</p><h2 id="配置运行环境" tabindex="-1">配置运行环境 <a class="header-anchor" href="#配置运行环境" aria-label="Permalink to &quot;配置运行环境&quot;">​</a></h2><h3 id="配置python依赖" tabindex="-1">配置python依赖 <a class="header-anchor" href="#配置python依赖" aria-label="Permalink to &quot;配置python依赖&quot;">​</a></h3><p>依赖版本:</p><div class="language-toml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dependencies = [</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 异步处理</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;asyncio&gt;=3.4.3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 控制算法</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;control&gt;=0.10.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # gradio客户端</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;gradio-client&gt;=1.8.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 线性代数</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;numpy&gt;=2.2.5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # ollama客户端</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;ollama&gt;=0.4.8&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 图像处理</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;opencv-python&gt;=4.11.0.86&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 图像处理</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;pillow&gt;=11.2.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 单元测试</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;pytest&gt;=8.3.5&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 科学计算</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;scipy&gt;=1.15.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # webots接口</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;webots&gt;=0.0.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # pid算法封装</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;simple-pid&gt;=2.0.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 网页代码编辑器</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;jupyter&gt;=1.1.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>安装依赖:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> seekslam_webots/controllers/mission6_supervisor</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">python</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="整体架构" tabindex="-1">整体架构 <a class="header-anchor" href="#整体架构" aria-label="Permalink to &quot;整体架构&quot;">​</a></h3><p>使用docker封印各个复杂算法模块, 实现函数式调用.</p><ul><li><p>核心算法:</p><ul><li>ocr目标识别模块: paddleocr<a href="https://paddlepaddle.github.io/PaddleOCR/main/ppocr/blog/PP-OCRv4_introduction.html" target="_blank" rel="noreferrer">@ref</a></li><li>建图模块: VGGT<a href="https://github.com/facebookresearch/vggt" target="_blank" rel="noreferrer">@ref</a></li><li>大模型视觉、思考及决策模块: <ul><li>MFDoom/deepseek-r1-tool-calling:1.5b<a href="https://ollama.com/MFDoom/deepseek-r1-tool-calling" target="_blank" rel="noreferrer">@ref</a></li><li>minicpm-v<a href="https://openbmb.vercel.app/minicpm-v-2" target="_blank" rel="noreferrer">@ref</a></li></ul></li><li>深度估计模块: depth-anything-v2<a href="https://github.com/DepthAnything/Depth-Anything-V2" target="_blank" rel="noreferrer">@ref</a></li></ul></li><li><p>核心传感器:</p><ul><li>10轴传感器(加速度计+陀螺仪+磁力计+气压计)</li><li>单目摄像头</li></ul></li><li><p>核心执行器</p><ul><li>电机x4</li><li>激光器</li></ul></li></ul><h3 id="配置docker容器运行算法模块" tabindex="-1">配置docker容器运行算法模块 <a class="header-anchor" href="#配置docker容器运行算法模块" aria-label="Permalink to &quot;配置docker容器运行算法模块&quot;">​</a></h3><p>算法模块已经&quot;封印&quot;到容器中了, 封印的意思是算法运行所依赖的环境和模型文件都打包到了容器中, 但是目前容器只有x86_64(amd64)版本.如果是arm64架构的苹果电脑(通过内置的二进制翻译器)也可以运行.</p><p>docker安装可以参考[<a href="https://www.docker.com/" target="_blank" rel="noreferrer">https://www.docker.com/</a>], 需要进入bios开启cpu的虚拟化。如果你的电脑此前已装过类似VMware虚拟机软件就不需要配置了。</p><p>容器镜像下载加速方法[<a href="https://docs.daocloud.io/community/mirror" target="_blank" rel="noreferrer">https://docs.daocloud.io/community/mirror</a>]</p><h4 id="_1-配置vggt建图模块" tabindex="-1">1. 配置VGGT建图模块 <a class="header-anchor" href="#_1-配置vggt建图模块" aria-label="Permalink to &quot;1. 配置VGGT建图模块&quot;">​</a></h4><p>参考:[<a href="https://www.cnblogs.com/qsbye/p/18830067" target="_blank" rel="noreferrer">https://www.cnblogs.com/qsbye/p/18830067</a>]</p><ol><li><p>下载及导入镜像</p><ul><li>百度云盘镜像(已包含模型权重<code>/home/user/.cache/torch/hub/checkpoints/model.pt</code>, 已修改为可使用cpu或cuda推理):</li></ul><div class="language-txt vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>通过网盘分享的文件：VGGT</span></span>
<span class="line"><span>链接: https://pan.baidu.com/s/1IH3qWMQMdMHpNZuTC9aHIA?pwd=zdfr 提取码: zdfr</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>导入:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> biu_facebook_vggt-v2-amd64.tar</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cpu版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7863:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> biu_face_vggt:v2-amd64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app_cpu.py</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cuda版本</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7863:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> biu_face_vggt:v2-amd64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>huggingface镜像(仅可cuda, 模型权重运行时才下载):</li></ul><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7863:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --platform=linux/amd64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --gpus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    registry.hf.space/facebook-vggt:latest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol><ul><li><p>访问[<a href="http://127.0.0.1:7863" target="_blank" rel="noreferrer">http://127.0.0.1:7863</a>]</p></li><li><p>提示✨: 默认工作目录为<code>/home/user/app</code></p></li></ul><ol start="3"><li>测试 <ul><li>方式1: 上传视频</li><li>方式2: 上传一张或多张图片</li></ul></li></ol><p><strong>记得修改<code>_mapping.py</code>代码中的xxx_SERVICE_URL字段</strong></p><h4 id="_2-使用ocr检测和识别字母" tabindex="-1">2. 使用OCR检测和识别字母 <a class="header-anchor" href="#_2-使用ocr检测和识别字母" aria-label="Permalink to &quot;2. 使用OCR检测和识别字母&quot;">​</a></h4><p>参考: [<a href="https://www.cnblogs.com/qsbye/p/18831983" target="_blank" rel="noreferrer">https://www.cnblogs.com/qsbye/p/18831983</a>]</p><ol><li>百度网盘整合包(包含模型)</li></ol><div class="language-txt vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>通过网盘分享的文件：OCR</span></span>
<span class="line"><span>链接: https://pan.baidu.com/s/1Q4DWvy4kFws-8vXBRlfwZg?pwd=g7bu 提取码: g7bu</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>运行:(默认使用cpu推理, 为了兼容性)</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> biu_openocr-v1-amd64.tar</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> biu_ppocr-v1-amd64.tar</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7865:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> biu_openocr:v1-amd64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.py</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7866:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> biu_ppocr:v1-amd64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.py</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7867:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> biu_paddleocr:v2-amd64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app_box.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>huggingface镜像(下载慢, 模型运行时才下载)</li></ol><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OpenOCR</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.hf.space/topdu-openocr-demo:cpu-1ceafe5</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7860:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --platform=linux/amd64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	registry.hf.space/topdu-openocr-demo:cpu-1ceafe5</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.py</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># docvqa + paddleocr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.hf.space/gaunernst-layoutlm-docvqa-paddleocr:cpu-90a9cee</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7860:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --platform=linux/amd64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	registry.hf.space/gaunernst-layoutlm-docvqa-paddleocr:cpu-90a9cee</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># paddleocr_v4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.hf.space/paddlepaddle-paddleocr:cpu-49fcf58</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7860:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --platform=linux/amd64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	registry.hf.space/paddlepaddle-paddleocr:cpu-49fcf58</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>记得修改<code>_ocr.py</code>代码中的xxx_SERVICE_URL字段</strong></p><h4 id="_3-大模型函数调用" tabindex="-1">3. 大模型函数调用 <a class="header-anchor" href="#_3-大模型函数调用" aria-label="Permalink to &quot;3. 大模型函数调用&quot;">​</a></h4><p>参考: [<a href="https://www.cnblogs.com/qsbye/p/18835026" target="_blank" rel="noreferrer">https://www.cnblogs.com/qsbye/p/18835026</a>]</p><blockquote><p>TODO: 将模型封印到镜像中.</p></blockquote><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ollama/ollama:0.6.6-rc2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name=ollama</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --restart=always</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 11434:11434</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;OLLAMA_HOST=0.0.0.0&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ollama/ollama:0.6.6-rc2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ollama</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MFDoom/deepseek-r1-tool-calling:1.5b</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ollama</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minicpm-v:latest</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>记得修改<code>_ollama.py</code>代码中的xxx_SERVICE_URL字段</strong></p><h4 id="_4-基于单目图像的深度估计" tabindex="-1">4. 基于单目图像的深度估计 <a class="header-anchor" href="#_4-基于单目图像的深度估计" aria-label="Permalink to &quot;4. 基于单目图像的深度估计&quot;">​</a></h4><p>参考: [<a href="https://www.cnblogs.com/qsbye/p/18840431" target="_blank" rel="noreferrer">https://www.cnblogs.com/qsbye/p/18840431</a>]</p><ol><li>百度网盘整合包(包含模型文件)</li></ol><ul><li>支持cpu/gpu模式</li></ul><div class="language-txt vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>通过网盘分享的文件：depth</span></span>
<span class="line"><span>链接: https://pan.baidu.com/s/1E_fACUNZEz6Mieqlr691Bg?pwd=9fgt 提取码: 9fgt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>使用:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># amd64</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">podman</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> load</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> depth-anything-v2.tar</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">podman</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name=depth</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7863:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> registry.hf.space/depth-anything-depth-anything-v2:zero-7f2e027</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>打开[<a href="http://127.0.0.1:7863" target="_blank" rel="noreferrer">http://127.0.0.1:7863</a>]</p><ol start="2"><li>方式2: huggingface的docker镜像(模型运行时下载) [<a href="https://huggingface.co/spaces/depth-anything/Depth-Anything-V2" target="_blank" rel="noreferrer">https://huggingface.co/spaces/depth-anything/Depth-Anything-V2</a>]</li></ol><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7860:7860</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --platform=linux/amd64</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --gpus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	registry.hf.space/depth-anything-depth-anything-v2:zero-7f2e027</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app.py</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>记得修改<code>_depth.py</code>代码中的xxx_SERVICE_URL字段</strong></p><h2 id="运行仿真" tabindex="-1">运行仿真 <a class="header-anchor" href="#运行仿真" aria-label="Permalink to &quot;运行仿真&quot;">​</a></h2><p>一切都配置完成后可以点击运行仿真了.可以观察时间轴观测仿真每步的结果, 也可以点按步进按钮单步执行仿真.仿真结束后可以进入<code>controllers/mission6_supervisor/images</code>文件夹查看图片处理结果.</p><ol><li>无人机起飞前初始化传感器及算法模块, 预热ollama模型</li><li>起飞后先悬停稳定, 然后缓慢环绕四周侦察并将图片送入建图模块进行初次室内建图</li><li>建图完成后调用深度估计模块估计四周的深度信息, 然后直接将深度图发布视觉大模型模块进行下一步方向的决策</li><li>决策完成后使用函数调用大模型调用封装的动作函数进行移动</li><li>使用<code>关键途径点</code>修正机器人轨迹</li><li>相机模块以1Hz速率向目标识别模块发布信息, 目标识别模块识别到目标后通知决策模块进行移动</li><li>决策模块在到达目标前方后使用深度估计模块估计与目标距离, 到达有效攻击范围后调用函数打开激光</li><li>原路返回然后降落</li></ol><table tabindex="0"><thead><tr><th>仿真时摄像头画面示例</th><th>建图结果示例</th></tr></thead><tbody><tr><td><img src="`+e+'" alt=""></td><td><img src="'+t+'" alt=""></td></tr></tbody></table><table tabindex="0"><thead><tr><th>仿真视频</th></tr></thead><tbody><tr><td><div class="video-file-player"><video controls src="'+h+'"></video></div></td></tr></tbody></table>',55)]))}const y=a(r,[["render",k]]);export{b as __pageData,y as default};
